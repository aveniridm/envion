<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ENVION · FAQ — Diagramma flussi &amp; esempio vline~ (12 terne)</title>
<style>
  :root{
    --bg:#ffffff;
    --fg:#0b0c0f;
    --muted:#5e6470;
    --accent:#2563eb;
    --card:#fbfbfc;
    --code:#0f172a;
    --code-bg:#f3f4f6;
    --border:#e6e8ef;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;line-height:1.55}
  a{color:var(--accent);text-decoration:none}
  a:hover{text-decoration:underline}
  .wrap{max-width:980px;margin:0 auto;padding:28px 18px 60px}
  header{display:flex;gap:14px;align-items:baseline;flex-wrap:wrap;margin-bottom:10px}
  header h1{font-size:clamp(1.4rem,3vw,2rem);margin:0}
  header .tag{font-size:.9rem;color:var(--muted);padding:.18rem .5rem;border:1px solid var(--border);border-radius:999px;background:var(--card)}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px;margin:16px 0}
  h2{font-size:clamp(1.1rem,2.4vw,1.4rem);margin:0 0 10px}
  h3{font-size:1.05rem;margin:14px 0 6px}
  p{margin:10px 0}
  .muted{color:var(--muted)}
  pre, code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  pre{background:var(--code-bg);color:var(--code);border:1px solid var(--border);padding:14px;border-radius:12px;overflow:auto;border-radius:12px}
  .svg-wrap{display:flex;justify-content:center;align-items:center;padding:8px;background:#f8fafc;border:1px solid var(--border);border-radius:14px;overflow:auto}
  .note{border-left:4px solid var(--accent);padding:12px 14px;background:#eef2ff;border-radius:10px;margin-top:10px}
  footer{margin-top:26px;font-size:.92rem;color:var(--muted)}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ENVION · Diagramma dei flussi &amp; esempio <code>vline~</code></h1>
      <span class="tag">Pure Data</span>
      <span class="tag">12 terne</span>
    </header>

    <div class="card">
      <h2>Diagramma dei flussi (parser dinamico)</h2>
      <div class="svg-wrap">
        <svg width="980" height="480" viewBox="0 0 980 480" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Diagramma flussi ENVION">
          <defs>
            <style>
              .box{fill:#ffffff;stroke:#a7b0c2;stroke-width:1.2}
              .title{font:600 14px system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, sans-serif;fill:#0b0c0f}
              .label{font:500 12px system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, sans-serif;fill:#374151}
              .small{font:500 11px system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, sans-serif;fill:#6b7280}
              .arrow{stroke:#64748b;stroke-width:1.3;marker-end:url(#arrow)}
              .accent{fill:#2563eb}
            </style>
            <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" class="accent" />
            </marker>
            <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
              <feDropShadow dx="0" dy="1.5" stdDeviation="1.2" flood-color="#c7d2fe" flood-opacity="0.7"/>
            </filter>
          </defs>

          <!-- Nodes -->
          <g filter="url(#shadow)">
            <rect x="40" y="30"  width="170" height="70" rx="12" class="box"/>
            <text x="125" y="60" text-anchor="middle" class="title">[text get]</text>
            <text x="125" y="80" text-anchor="middle" class="small">riga completa</text>

            <rect x="260" y="30" width="190" height="70" rx="12" class="box"/>
            <text x="355" y="60" text-anchor="middle" class="title">[list store]</text>
            <text x="355" y="80" text-anchor="middle" class="small">buffer riga</text>

            <rect x="520" y="20" width="160" height="50" rx="12" class="box"/>
            <text x="600" y="50" text-anchor="middle" class="title">[bang]</text>

            <rect x="520" y="90" width="160" height="70" rx="12" class="box"/>
            <text x="600" y="120" text-anchor="middle" class="title">[until]</text>
            <text x="600" y="140" text-anchor="middle" class="small">loop finché resta lista</text>

            <rect x="730" y="30" width="210" height="70" rx="12" class="box"/>
            <text x="835" y="55" text-anchor="middle" class="title">[list length]</text>
            <text x="835" y="75" text-anchor="middle" class="small">&lt; 3 → stop</text>

            <rect x="730" y="120" width="210" height="70" rx="12" class="box"/>
            <text x="835" y="145" text-anchor="middle" class="title">[list split 3]</text>
            <text x="835" y="165" text-anchor="middle" class="small">1 terna + resto</text>

            <rect x="520" y="220" width="420" height="90" rx="12" class="box"/>
            <text x="730" y="250" text-anchor="middle" class="title">[pd envelope-segment]</text>
            <text x="730" y="270" text-anchor="middle" class="small">costruisce pezzo di messaggio per vline~</text>

            <rect x="520" y="340" width="420" height="90" rx="12" class="box"/>
            <text x="730" y="370" text-anchor="middle" class="title">[vline~]</text>
            <text x="730" y="390" text-anchor="middle" class="small">esegue i ramp target/time/delay</text>
          </g>

          <!-- Arrows -->
          <line x1="210" y1="65" x2="260" y2="65" class="arrow"/>
          <line x1="450" y1="65" x2="520" y2="45" class="arrow"/>
          <line x1="600" y1="70" x2="600" y2="90" class="arrow"/>
          <line x1="680" y1="125" x2="730" y2="65" class="arrow"/>
          <line x1="680" y1="145" x2="730" y2="155" class="arrow"/>
          <line x1="835" y1="190" x2="835" y2="220" class="arrow"/>
          <line x1="835" y1="310" x2="835" y2="340" class="arrow"/>

          <!-- Loopback arrow from list split remainder to until -->
          <path d="M 730 155 H 560 V 180 H 600" fill="none" class="arrow"/>
          <text x="565" y="175" class="small">resto → continua</text>
        </svg>
      </div>
      <p class="muted">Il ciclo legge la riga, spezza in terne e invia ciascun segmento a una subpatch che accumula/programma i ramp per <code>vline~</code>.</p>
    </div>

    <div class="card">
      <h2>Esempio di messaggio per <code>vline~</code> (12 terne)</h2>
      <p>Dato questo set (12 terne sulla stessa riga):</p>
      <pre><code>0.6 120 0  0.4 90 0  0.2 60 0  0.0 30 80  0.7 110 0  0.3 70 0  0.5 100 0  0.1 50 0  0.8 95 0  0.2 40 60  0.6 85 0  0.0 30 120;</code></pre>

      <h3>Formato “lista unica” (senza virgole)</h3>
      <pre><code>0.6 120 0  0.4 90 0  0.2 60 0  0.0 30 80  0.7 110 0  0.3 70 0  0.5 100 0  0.1 50 0  0.8 95 0  0.2 40 60  0.6 85 0  0.0 30 120</code></pre>
      <p class="muted">Inviata come singolo messaggio a <code>vline~</code> (es. via <code>[list trim]</code> → <code>[vline~]</code>), eseguirà tutti i segmenti in sequenza.</p>

      <h3>Formato “message box” con virgole</h3>
      <pre><code>0.6 120 0,
0.4 90 0,
0.2 60 0,
0.0 30 80,
0.7 110 0,
0.3 70 0,
0.5 100 0,
0.1 50 0,
0.8 95 0,
0.2 40 60,
0.6 85 0,
0.0 30 120</code></pre>
      <p class="muted">Le virgole separano più messaggi nello stesso box, utile se vuoi ispezionare/modificare i singoli passaggi a mano.</p>

      <div class="note">
        <strong>Timing globale</strong><br/>
        Ricorda che nella tua patch la durata effettiva è scalata da <code>$0-factor</code> (derivato da <em>Tarray</em>). Se cambi il factor, l’intero profilo temporale viene “stretchato”/“compresso” in modo coerente.
      </div>
    </div>

    <footer>
      Preparato per la guida di ENVION · Emiliano Pennisi — Diagramma e messaggi vline~ per 12 terne.
    </footer>
  </div>
</body>
</html>
